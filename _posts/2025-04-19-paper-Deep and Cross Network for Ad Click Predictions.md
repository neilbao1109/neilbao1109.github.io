---
title: Deep & Cross Network for Ad Click Predictions 
date: 2025-04-19 10:00:00 +0800
categories: [Paper, Ad Click Prediction]
tags: [dcn]
render_with_liquid: false
---

《Deep & Cross Network for Ad Click Predictions》（简称 **DCN**）是由 Google Research 在 2017 年发布的一篇经典论文。它是推荐系统和广告点击率（CTR）预测领域的重要里程碑，旨在解决如何**自动且高效地学习特征交叉**的问题。


---

### 1. 核心背景：为什么要设计 DCN？

在广告预测系统中，**特征交叉（Feature Crossing）**至关重要。

* **例子**：如果一个用户在“纽约”且当前是“冬季”，那么他点击“羽绒服”广告的概率会大大增加。这种特征组合比单一特征更具预测力。
* **传统做法的缺陷**：
* **人工工程**：以前需要专家手动组合特征（如 Wide & Deep 中的 Wide 部分），这非常耗时且难以覆盖所有高阶组合。
* **普通 DNN（深度神经网络）**：虽然能学习隐含的非线性关系，但它学习特定阶数的特征交叉效率较低，且其过程是“黑盒”，不透明。



---

### 2. DCN 的模型架构

DCN 的核心思想是**将显式的特征交叉（Cross Network）与隐式的深度学习（Deep Network）结合起来**。

#### A. 嵌入层 (Embedding Layer)

由于广告数据大多是稀疏的（如类别特征 ID），DCN 首先通过 Embedding 将高维稀疏特征映射为低维稠密向量，然后拼接成一个长向量  作为后续两部分的共同输入。

#### B. Cross Network（核心创新：交叉网络）

这是 DCN 最精华的部分。它通过特殊的层结构，显式地计算特征之间的交叉。

* **计算公式**：


*  是初始输入。
*  是第  层的输出。
*  和  是该层的可学习参数。


* **特点**：
1. **阶数可控**：每增加一层，特征交叉的阶数就增加一阶。如果 Cross Network 有  层，它就能捕获最高  阶的特征交叉。
2. **参数效率极高**：其参数量与输入维度成线性关系，远低于全连接层。
3. **残差结构**：公式末尾的  借鉴了 ResNet 的思想，有助于缓解梯度消失问题，使模型能建得更深。



#### C. Deep Network（深度网络）

这是一个标准的多层感知机（MLP），使用 ReLU 激活函数。它的作用是捕捉输入特征之间复杂的、高度非线性的**隐式关系**。

#### D. 融合层 (Combination Layer)

最后，将 Cross Network 的输出和 Deep Network 的输出**拼接（Concatenate）**在一起，通过一个逻辑回归（Sigmoid）输出最终的点击概率。

---

### 3. DCN 的主要优势

1. **自动化**：不再需要大规模的人工特征工程，模型会自动寻找有用的高阶组合特征。
2. **显式 + 隐式结合**：Cross Network 负责学习有界阶数的显式交叉（可解释性强），Deep Network 负责学习深层的隐式非线性规律。
3. **计算高效**：相比于直接在全连接层中模拟高阶交叉，Cross Network 的计算量和内存占用都非常小，适合大规模在线工业系统。
4. **性能卓越**：在 Criteo 等主流 CTR 数据集上，DCN 的表现优于当时的 Wide & Deep、FM 以及纯 DNN 模型。

---

### 4. 后续演进：DCN-V2

Google 后来在 2020 年推出了 **DCN-V2**。

* **改进点**：原始 DCN 的 Cross Network 矩阵秩（Rank）较低，限制了表达能力。V2 版本引入了**矩阵分解（Low-rank decomposition）**和更灵活的结构，使其在处理大规模复杂特征时表现更强，目前仍是很多大厂（如美团、字节）推荐算法的重要参考。

### 总结

**DCN 解决了“深度学习模型不擅长显式建模特征交叉”的痛点。** 它用一个优雅的数学公式（Cross Layer）实现了高阶特征组合的自动提取，是理解现代推荐系统（如 DeepFM, xDeepFM 等）演进路线的必读论文。