---
title: Deep Interest Network for Click-Through Rate Prediction
date: 2024-10-05 13:00:00 +0800
categories: [Paper, Ad Click Prediction]
tags: [din]
render_with_liquid: false
---

《Deep Interest Network for Click-Through Rate Prediction》（简称 **DIN**）由**阿里巴巴**团队在 2018 年发表。这篇论文是推荐系统发展史上的一个**分水岭**，它第一次正式引入了**注意力机制（Attention）**来捕捉用户多样的兴趣，解决了传统模型在处理用户历史行为时的“平均化”痛点。

---

### 1. 核心痛点：固定长度向量的瓶颈

在 DIN 出现之前，主流模型（如 Wide & Deep, DeepFM）处理用户历史行为（点击过的商品序列）的方式通常是：

1. 将历史行为对应的 Embedding 找出来。
2. 通过 **Sum Pooling** 或 **Average Pooling** 把它们加起来或平均一下，变成一个**固定长度**的向量。

**这种做法的问题在于：**

* **信息损失**：一个用户可能买过雨伞、书、零食。如果把这些兴趣全部平均，得到的向量会非常模糊，无法代表用户在某一特定时刻的真实意图。
* **局部激活缺失**：当用户看到一个新的广告（目标商品，如“电子书”）时，他过去买“书”的行为应该起决定性作用，而买“雨伞”的行为应该被忽略。传统的平均做法无法做到这种“因地制宜”的匹配。

---

### 2. DIN 的创新：局部激活单元 (Local Activation Unit)

DIN 的核心创新是引入了 **Attention 机制**。它认为：用户的兴趣表示不应该是静态的，而应该随**目标商品（Target Item）**的变化而变化。

#### 核心公式：

用户的兴趣向量  不再是简单的平均，而是加权和：


* ：用户历史行为中第  个商品的 Embedding。
* ：当前要预测的目标商品（广告）的 Embedding。
* ：**激活函数（Activation Unit）**，计算目标商品与历史商品之间的相关性（即权重）。

**直观理解**：如果你现在看的是“泳镜”，DIN 会自动调高你过去买过的“泳衣”、“防晒霜”的权重，而调低你买过的“编程书”的权重。

---

### 3. 工程上的两大改进

除了模型架构，阿里在论文中还提出了两个对工业界非常有帮助的优化：

1. **Dice 激活函数**：
* 传统的 ReLU 在输入为 0 时导数为 0，容易导致神经元死亡。
* Dice 根据数据的分布动态调整修正方向，专门针对 CTR 数据这种分布极不均匀（长尾分布）的情况进行了优化。


2. **自适应正则化 (Adaptive Regularization)**：
* 在处理数亿维度的稀疏特征时，传统的  正则化计算量巨大且容易过拟合。
* DIN 提出只对每个小批量（Mini-batch）中出现的非零特征进行正则化计算，极大提升了训练效率。



---

### 4. 实验结果与行业影响

* **性能提升**：在阿里真实的广告展示数据和公开数据集上，DIN 的 AUC（曲线下面积，衡量点击率预测的核心指标）显著优于当时的最强基准（Base Model）。
* **行业意义**：DIN 开启了推荐系统进入“**用户行为序列建模**”的时代。此后出现的 DIEN（引入时间序列）、DSIN（引入 Session）以及你之前提到的 DMIN，本质上都是在 DIN 的基础上对“用户兴趣”进行更深度的挖掘。

---

### 总结

**DIN 就像是给推荐系统装上了一双“会观察”的眼睛。** 它告诉我们：预测用户会不会点一个商品，不能只看他过去总体的样子，更要看他过去哪些行为跟这个特定的商品“对得上眼”。
