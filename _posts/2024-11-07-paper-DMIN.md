---
title: Deep Multi-Interest Network for Click-through Rate Prediction 
date: 2024-11-07 12:00:00 +0800
categories: [Paper, Ad Click Prediction]
tags: [dmin]
render_with_liquid: false
---

《Deep Multi-Interest Network for Click-through Rate Prediction》（简称 **DMIN**）是由**阿里巴巴/蚂蚁金服**团队在 2020 年发表的一篇论文。

它是推荐系统领域中处理**用户行为序列**的进阶作。如果说之前的 DIN 解决了“相关性”问题，DIEN 解决了“演化”问题，那么 **DMIN 解决的就是用户兴趣的“多样性（Multi-Interest）”与“细粒度捕捉”问题。**

---

## 1. 核心动机：为什么要提取“多兴趣”？

在传统的序列模型（如 DIN 或 DIEN）中，模型通常试图将用户的历史行为压缩成一个或几个统一的向量。但现实中，用户的兴趣是**多样的且共存的**：

* 一个用户可能同时对“数码产品”、“宠物用品”和“健身器材”感兴趣。
* **DIN 的局限**：它通过当前目标商品（Target Item）去历史里“检索”相关信息。如果目标商品和历史兴趣跨度太大，注意力机制可能失效。
* **DIEN 的局限**：它虽然捕获了兴趣的演化，但往往倾向于捕捉一个总体的兴趣流，难以处理并行存在的多个独立兴趣线。

**DMIN 的核心思想：** 在与目标商品交互之前，先主动从用户的历史行为中提取出多个独立的“兴趣通道”，并分别建模这些兴趣的演化。

---

## 2. DMIN 的核心架构

DMIN 的结构设计非常精巧，主要由以下三个关键层组成：

### A. 行为序列层与位置编码 (Behavior Layer with Positional Encoding)

模型首先将用户点击过的商品序列进行 Embedding，并加入**位置编码（Positional Encoding）**。这确保了模型不仅知道用户买了什么，还知道这些行为发生的先后顺序。

### B. 多兴趣提取层 (Multi-Interest Extractor Layer)

这是 DMIN 的灵魂。它使用了 **Multi-Head Self-Attention（多头自注意力机制）**：

* **做法**：通过不同的“头（Heads）”，让历史行为之间进行相互关注。
* **目的**：每个“头”可以学习到用户不同维度的兴趣。例如，Head 1 可能关注用户对品牌的偏好，Head 2 可能关注用户对品类的偏好。
* **结果**：这一层输出的是多个并行的兴趣表示，而不是一个单一的向量。

### C. 兴趣演化层 (Interest Evolution Layer)

提取出多组兴趣后，DMIN 借鉴了 DIEN 的思路，对**每一组**兴趣分别使用 **GRU/AUGRU**（带注意力机制的门控循环单元）进行建模。

* 这使得模型能够捕捉到：用户在“数码”这个垂直领域的兴趣是怎么随时间变化的，而在“宠物”领域又是怎么变化的。

---

## 3. DMIN 与前辈们的对比

为了方便理解，我们可以看这个演进链条：

| 模型 | 核心创新点 | 解决的问题 |
| --- | --- | --- |
| **DIN** | 引入注意力机制 (Attention) | 解决了历史行为中哪些对当前预测更重要的问题。 |
| **DIEN** | 引入兴趣演化 (Interest Evolution) | 解决了兴趣随时间变化（演化趋势）的问题。 |
| **DMIN** | **多头自注意力 + 多兴趣演化** | 解决了用户兴趣**多样性**和**不同兴趣并行演化**的问题。 |

---

## 4. DMIN 的主要贡献与优势

1. **更强的表达能力**：通过多头机制，DMIN 能更细致地解耦用户的复杂动机，减少了噪音干扰（比如用户偶尔的乱点）。
2. **建模更深**：它不仅提取了多兴趣，还对这些兴趣的**演化路径**进行了精细化建模。
3. **工业落地性**：在阿里巴巴的实际业务（如支付宝、口碑等）中，DMIN 相比 DIN 和 DIEN 都有显著的点击率提升。

---

### 总结

DMIN 是对用户行为序列建模的“深度挖掘”。它认为用户不是一个简单的标签集合，而是一个由多个独立兴趣线交织而成的动态个体。
